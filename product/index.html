<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>รายละเอียดสินค้า</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;700&display=swap');
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #f5f5f5;
        }
        .product-image {
            display: none;
        }
        .price-tag {
            position: relative;
        }
        .price-tag::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            border-top: 1px solid #777;
        }
        .image-carousel {
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            display: flex;
            overflow-x: auto;
            overflow-y: hidden;
        }
        .image-carousel::-webkit-scroll {
            display: none;
        }
        .carousel-item {
            scroll-snap-align: start;
            flex-shrink: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body class="text-gray-800 bg-gray-100">
<!-- head -->
<header class="bg-white sticky top-0 shadow-md z-10">
    <div class="container mx-auto p-4 flex items-center justify-between">
        <div class="flex items-center">
    <button class="mr-4 text-xl text-gray-700 hover:text-gray-900 focus:outline-none">
        <i class="fas fa-arrow-left"></i>
    </button>
    <h1 class="text-lg font-semibold text-gray-800">รายละเอียดสินค้า</h1>
        </div>
        <div class="flex items-center">
    <button class="text-xl text-gray-700 hover:text-gray-900 focus:outline-none relative">
        <i class="fas fa-shopping-cart"></i>
    </button>
        </div>
    </div>
</header>

    <!-- Product Images -->
<div class="relative bg-white">
    <div class="image-carousel h-80" id="imageCarousel">
        <div class="carousel-item h-full" onclick="openImageViewer(0)">
            <svg class="w-full h-full" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f8f8f8"/>
                <circle cx="200" cy="200" r="120" fill="#db2777" opacity="0.2"/>
                <rect x="120" y="120" width="160" height="160" fill="#db2777" opacity="0.3"/>
            </svg>
        </div>
        <div class="carousel-item h-full" onclick="openImageViewer(1)">
            <svg class="w-full h-full" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f8f8f8"/>
                <circle cx="200" cy="200" r="120" fill="#db2777" opacity="0.4"/>
                <polygon points="200,100 300,250 100,250" fill="#db2777" opacity="0.3"/>
            </svg>
        </div>
        <div class="carousel-item h-full" onclick="openImageViewer(2)">
            <svg class="w-full h-full" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f8f8f8"/>
                <rect x="100" y="100" width="200" height="200" fill="#db2777" opacity="0.2"/>
                <circle cx="200" cy="200" r="80" fill="#db2777" opacity="0.4"/>
            </svg>
        </div>
        <div class="carousel-item h-full" onclick="openImageViewer(3)">
            <svg class="w-full h-full" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f8f8f8"/>
                <polygon points="200,100 300,200 200,300 100,200" fill="#db2777" opacity="0.3"/>
                <circle cx="200" cy="200" r="50" fill="#db2777" opacity="0.5"/>
            </svg>
        </div>
        
        <!-- Image Counter -->
        <div class="absolute top-4 right-4 bg-black bg-opacity-50 text-white px-2 py-1 rounded-full text-xs">
            <span id="current-image">1</span>/4
        </div>
    </div>
</div>

<!-- Product Info -->
<div class="bg-white p-4 mt-2">
    <!-- Price Section -->
    <div class="mb-3">
        <div class="flex items-baseline">
            <span class="text-pink-600 text-2xl font-bold">฿590</span>
            <span class="text-gray-500 text-sm ml-2 price-tag">฿990</span>
            <span class="ml-2 bg-pink-600 text-white text-xs px-1 rounded">-40%</span>
        </div>
        <div class="mt-1 inline-block bg-pink-100 text-pink-600 text-xs px-2 py-1 rounded">
            <i class="fas fa-ticket-alt mr-1"></i>คูปองลด ฿50
        </div>
    </div>
    
    <!-- Product Title -->
    <h1 class="text-lg font-medium mb-2">เสื้อยืดคอกลมแฟชั่น ผ้านุ่ม ใส่สบาย ทรงสวย</h1>
</div>

<!-- Shipping Info -->
<div class="bg-white p-4 mt-2 flex items-center text-sm">
    <i class="fas fa-truck mr-3 text-pink-600 text-lg"></i>
    <span>สั่งซื้อ ฿200 ขึ้นไปเพื่อรับสิทธิ์จัดส่งฟรี</span>
</div>

<!-- Product Details -->
<div class="bg-white p-4 mt-2">
    <h2 class="text-lg font-medium mb-3">รายละเอียดสินค้า</h2>
    <div class="text-sm text-gray-700 space-y-2">
        <p>• เสื้อยืดคอกลมผลิตจากผ้าคอตตอน 100% เนื้อนุ่ม</p>
        <p>• ระบายอากาศได้ดี ไม่ร้อนอบอ้าว</p>
        <p>• ตัดเย็บอย่างประณีต ทนทานต่อการซัก</p>
        <p>• มีให้เลือกหลากหลายสี</p>
        <p>• ไซส์: S, M, L, XL, XXL</p>
        <p>• สามารถซักด้วยเครื่องซักผ้าได้</p>
    </div>
    
    <div class="mt-4 border-t pt-4">
        <div class="flex justify-between mb-2">
            <span class="text-gray-600">แบรนด์</span>
            <span>FashionTH</span>
        </div>
        <div class="flex justify-between mb-2">
            <span class="text-gray-600">วัสดุ</span>
            <span>คอตตอน 100%</span>
        </div>
        <div class="flex justify-between mb-2">
            <span class="text-gray-600">น้ำหนัก</span>
            <span>250 กรัม</span>
        </div>
        <div class="flex justify-between">
            <span class="text-gray-600">แหล่งผลิต</span>
            <span>ประเทศไทย</span>
        </div>
    </div>
</div>

<!-- Image Viewer Modal -->
<div id="imageViewer" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden flex items-center justify-center">
    <div class="absolute top-4 right-4">
        <button onclick="closeImageViewer()" class="text-white text-2xl">
            <i class="fas fa-times"></i>
        </button>
    </div>
    <div class="image-carousel w-full h-full" id="fullImageCarousel">
        <div class="carousel-item h-full flex items-center justify-center">
            <svg class="w-full h-auto max-h-full" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f8f8f8"/>
                <circle cx="200" cy="200" r="120" fill="#db2777" opacity="0.2"/>
                <rect x="120" y="120" width="160" height="160" fill="#db2777" opacity="0.3"/>
            </svg>
        </div>
        <div class="carousel-item h-full flex items-center justify-center">
            <svg class="w-full h-auto max-h-full" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f8f8f8"/>
                <circle cx="200" cy="200" r="120" fill="#db2777" opacity="0.4"/>
                <polygon points="200,100 300,250 100,250" fill="#db2777" opacity="0.3"/>
            </svg>
        </div>
        <div class="carousel-item h-full flex items-center justify-center">
            <svg class="w-full h-auto max-h-full" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f8f8f8"/>
                <rect x="100" y="100" width="200" height="200" fill="#db2777" opacity="0.2"/>
                <circle cx="200" cy="200" r="80" fill="#db2777" opacity="0.4"/>
            </svg>
        </div>
        <div class="carousel-item h-full flex items-center justify-center">
            <svg class="w-full h-auto max-h-full" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f8f8f8"/>
                <polygon points="200,100 300,200 200,300 100,200" fill="#db2777" opacity="0.3"/>
                <circle cx="200" cy="200" r="50" fill="#db2777" opacity="0.5"/>
            </svg>
        </div>
    </div>
</div>

<!-- Bottom Action Bar -->
<div class="fixed bottom-0 left-0 right-0 bg-white border-t flex items-center p-3 z-40">
    <div class="flex space-x-3 flex-1">
        <button class="flex flex-col items-center justify-center text-gray-600 text-xs">
            <i class="fas fa-store text-lg mb-1"></i>
            <span>ร้านค้า</span>
        </button>
        <button class="flex flex-col items-center justify-center text-gray-600 text-xs">
            <i class="fas fa-comments text-lg mb-1"></i>
            <span>แชท</span>
        </button>
    </div>
    <div class="flex space-x-2 flex-[2]">
        <button class="flex-[1.2] bg-pink-100 text-pink-600 py-3 rounded-full font-medium text-sm">
            เพิ่มลงตะกร้า
        </button>
        <button class="flex-1 bg-pink-600 text-white py-3 rounded-full font-medium text-sm">
            ซื้อเลย
        </button>
    </div>
</div>

    <script>
const carousel = document.getElementById('imageCarousel');
const fullCarousel = document.getElementById('fullImageCarousel');
const imageViewer = document.getElementById('imageViewer');
const currentImageText = document.getElementById('current-image');
let currentIndex = 0;

function getQueryParam(param) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(param);
}

// ฟังก์ชันเปิด/ปิด modal รูปภาพ (เหมือนเดิม)
function openImageViewer(index) {
  imageViewer.classList.remove('hidden');
  document.body.style.overflow = 'hidden';
  fullCarousel.scrollTo({
    left: index * fullCarousel.offsetWidth,
    behavior: 'instant'
  });
}
function closeImageViewer() {
  imageViewer.classList.add('hidden');
  document.body.style.overflow = '';
}

// โหลดข้อมูลสินค้าและแสดงผล
async function loadProduct() {
  const id = getQueryParam('id');
  if (!id) {
    alert('ไม่พบรหัสสินค้า');
    return;
  }
  try {
    const response = await fetch('products.json');
    const products = await response.json();
    const product = products.find(p => p.id === id);
    if (!product) {
      alert('ไม่พบสินค้านี้');
      return;
    }

    // อัพเดตรูปภาพ carousel (แทนที่ svg เดิม)
    carousel.innerHTML = '';
    fullCarousel.innerHTML = '';
    product.images.forEach((imgUrl, i) => {
      // สร้างภาพเล็ก
      const thumbDiv = document.createElement('div');
      thumbDiv.className = 'carousel-item h-full';
      thumbDiv.onclick = () => openImageViewer(i);
      const imgThumb = document.createElement('img');
      imgThumb.src = imgUrl;
      imgThumb.alt = product.title;
      imgThumb.className = 'w-full h-full object-contain';
      thumbDiv.appendChild(imgThumb);
      carousel.appendChild(thumbDiv);

      // สร้างภาพใหญ่ใน modal
      const fullDiv = document.createElement('div');
      fullDiv.className = 'carousel-item h-full flex items-center justify-center';
      const imgFull = document.createElement('img');
      imgFull.src = imgUrl;
      imgFull.alt = product.title;
      imgFull.className = 'w-full h-auto max-h-full object-contain';
      fullDiv.appendChild(imgFull);
      fullCarousel.appendChild(fullDiv);
    });

    // อัพเดทราคา
    document.querySelector('.text-pink-600.text-2xl.font-bold').textContent = `฿${product.price}`;
    document.querySelector('.price-tag').textContent = `฿${product.originalPrice}`;
    document.querySelector('.price-tag').style.position = 'relative'; // ให้เส้นขีดราคาปรากฏ
    document.querySelector('.ml-2.bg-pink-600.text-white.text-xs.px-1.rounded').textContent = `-${product.discountPercent}%`;

    // คูปอง
    document.querySelector('.mt-1.inline-block.bg-pink-100.text-pink-600.text-xs.px-2.py-1.rounded i').nextSibling.textContent = `คูปองลด ฿${product.coupon}`;

    // ชื่อสินค้า
    document.querySelector('h1.text-lg.font-medium.mb-2').textContent = product.title;

    // ข้อมูลจัดส่ง
    document.querySelector('.bg-white.p-4.mt-2.flex.items-center.text-sm span').textContent = product.shippingCondition;

    // รายละเอียดสินค้า (ช่องรายละเอียด)
    const detailDiv = document.querySelector('.bg-white.p-4.mt-2 > div.text-sm.text-gray-700.space-y-2');
    detailDiv.innerHTML = '';
    product.description.forEach(line => {
      const p = document.createElement('p');
      p.textContent = `• ${line}`;
      detailDiv.appendChild(p);
    });

    // ข้อมูลเสริมแบรนด์ วัสดุ น้ำหนัก แหล่งผลิต
    const brandDivs = document.querySelectorAll('.bg-white.p-4.mt-2 > div.mt-4.border-t.pt-4 > div.flex.justify-between');
    brandDivs[0].children[1].textContent = product.brand;
    brandDivs[1].children[1].textContent = product.material;
    brandDivs[2].children[1].textContent = product.weight;
    brandDivs[3].children[1].textContent = product.origin;

  } catch (error) {
    console.error(error);
    alert('เกิดข้อผิดพลาดในการโหลดข้อมูลสินค้า');
  }
}

// ตัวอัพเดตตัวนับรูปภาพเวลาสไลด์
carousel.addEventListener('scroll', () => {
  const scrollPosition = carousel.scrollLeft;
  const itemWidth = carousel.offsetWidth;
  currentIndex = Math.round(scrollPosition / itemWidth);
  currentImageText.textContent = currentIndex + 1;
});

// อัพเดต carousel modal เมื่อเลื่อนใน modal
fullCarousel.addEventListener('scroll', () => {
  const scrollPosition = fullCarousel.scrollLeft;
  const itemWidth = fullCarousel.offsetWidth;
  const viewerIndex = Math.round(scrollPosition / itemWidth);
  if (viewerIndex !== currentIndex) {
    carousel.scrollTo({
      left: viewerIndex * carousel.offsetWidth,
      behavior: 'instant'
    });
    currentIndex = viewerIndex;
    currentImageText.textContent = currentIndex + 1;
  }
});

// เรียกโหลดข้อมูลตอนเปิดหน้า
loadProduct();
    </script>
</body>
</html>
